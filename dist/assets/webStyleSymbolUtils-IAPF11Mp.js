import{c as x,a as w}from"./devEnvironmentUtils-BfO8ai13.js";import{C as $,I as c,s as u,d6 as S,dZ as D,d_ as v,d$ as F,e0 as O,e1 as A,e2 as N,e3 as U,e4 as M,e5 as R,e6 as W}from"./index-DzoQLc5A.js";import"https://js.arcgis.com/map-components/4.33/arcgis-map-components.esm.js";const Z=["web-gltf","web","cim"];function H(t,e,l){const a=t.name;return a==null?Promise.reject(new u("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?q(a,e,l):M(t,e,l).then((n=>k(n,a,e,R,l)))}function _(t,e){return e.items.find((l=>l.name===t))}async function k(t,e,l,a,n){var d,h;const o=(l==null?void 0:l.portal)!=null?l.portal:$.getDefault(),r={portal:o,url:c(t.baseUrl)},m=_(e,t.data);if(!m)throw new u("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const b=(n==null?void 0:n.acceptedFormats)??Z,p=a(m,b);if(!p)throw new u("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${b})`,{symbolName:e});const{url:P,format:T}=p;let i=S(P,r),y=((d=m.thumbnail)==null?void 0:d.href)??null;const f=(h=m.thumbnail)==null?void 0:h.imageData;x()&&(i=w(i)??"",y=w(y));const C={portal:o,url:c(D(i)),origin:"portal-item"};return v(i,n).then((g=>{const E=T==="cim"?F(g.data):g.data,s=O(E,C);if(s&&A(s)){if(y){const I=S(y,r);s.thumbnail=new N({url:I})}else f&&(s.thumbnail=new N({url:`data:image/png;base64,${f}`}));t.styleUrl?s.styleOrigin=new U({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(s.styleOrigin=new U({portal:l.portal,styleName:t.styleName,name:e}))}return s}))}function q(t,e,l){const a=W.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:$.getDefault();return v(a,l).then((o=>{const r=F(o.data);return O(r,{portal:n,url:c(D(a)),origin:"portal-item"})}))}export{k as fetchSymbolFromStyle,_ as getStyleItemFromStyle,H as resolveWebStyleSymbol};
