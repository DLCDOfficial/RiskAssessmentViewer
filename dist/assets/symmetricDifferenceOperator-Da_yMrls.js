import{L as R}from"./index-DzoQLc5A.js";import{s as y,t as T}from"./SimpleGeometryCursor-B92kdZ15.js";import{d as A,j as v,a as p,m as S,Y}from"./Point2D-C8Vjr_uf.js";import{A as j,ag as k,F as E,E as q}from"./ProjectionTransformation-CSOGIsAN.js";import{Envelope2D as g}from"./Envelope2D-Da8Eb6by.js";import{fromGeometry as d,getSpatialReference as P,fromSpatialReference as D,toGeometry as b}from"./apiConverter-C4nPBqvs.js";class I{getOperatorType(){return 10003}supportsCurves(){return!0}accelerateGeometry(e,n,o){return!1}canAccelerateGeometry(e){return!1}executeMany(e,n,o,r){return new $(e,n,o,r)}execute(e,n,o,r){const i=new y([e]),a=new y([n]),s=this.executeMany(i,a,o,r).next();return s||A("null output"),s}}function O(t,e,n,o){const r=t.getDimension(),i=e.getDimension();if(r!==i)return r>i?t:e;if(t.isEmpty())return e;if(e.isEmpty())return t;const a=new g,s=new g,u=new g;t.queryEnvelope(a),e.queryEnvelope(s),u.setCoords({env2D:a}),u.mergeEnvelope2D(s);const c=j(n,u,!0),f=t.getGeometryType(),l=e.getGeometryType();return f===p.enumPoint&&l===p.enumPoint?X(t,e,c):f===p.enumPoint&&l===p.enumMultiPoint?w(e,t,c):f===p.enumMultiPoint&&l===p.enumPoint?w(t,e,c):k(t,e,n,o)}function X(t,e,n,o){const r=E(n),i=r*r,a=t.getXY(),s=e.getXY(),u=new q({vd:t.getDescription()});return S.sqrDistance(a,s)>i&&(u.add(t),u.add(e)),u}function w(t,e,n,o){const r=t.getImpl().getAttributeStreamRef(0),i=t.getPointCount(),a=e.getXY(),s=t.createInstance(),u=E(n),c=new g;if(t.queryEnvelope(c),c.inflateCoords(u,u),c.contains(a)){const f=u*u;let l=!1;const _=Y(i,!1);for(let m=0;m<i;m++){const C=r.read(2*m),M=r.read(2*m+1),x=C-a.x,G=M-a.y;x*x+G*G<=f&&(l=!0,_[m]=!0)}if(l)for(let m=0;m<i;m++)_[m]||s.addPoints(t,m,m+1);else s.addPoints(t,0,i),s.add(e)}else s.addPoints(t,0,i),s.add(e);return s}class $ extends T{constructor(e,n,o,r){super(),this.m_progressTracker=r,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=o,this.m_rightGeom=n.next(),this.m_bEmpty=!this.m_rightGeom,v(this.m_rightGeom)}tock(){return!0}getRank(){return 1}next(){if(this.m_bEmpty)return null;const e=this.m_inputGeoms.next();return e?(v(e),this.m_index=this.m_inputGeoms.getGeometryID(),O(e,this.m_rightGeom,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}}const h=new I;function F(t,e,n){return h.execute(t,e,n,null)}function z(t,e,n){const o=h.executeMany(new y(t),new y([e]),n,null);return Array.from(o)}function L(){return h.supportsCurves()}function Z(t,e){const n=P(t);return b(F(d(t),d(e),D(n)),n)}function B(t,e){const n=t.map(d),o=P(t);return z(n,d(e),D(o)).map((r=>b(r,o))).filter(R)}const H=L(),W=Object.freeze(Object.defineProperty({__proto__:null,execute:Z,executeMany:B,supportsCurves:H},Symbol.toStringTag,{value:"Module"}));export{B as c,W as i,H as m,Z as u};
