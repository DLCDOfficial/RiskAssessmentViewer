import{L as F}from"./index-DzoQLc5A.js";import{t as K}from"./SimpleGeometryCursor-B92kdZ15.js";import{a as U,d as j,n as L}from"./Point2D-C8Vjr_uf.js";import{a as w,aO as M,A as Q,u as g,P as x,aP as I,aQ as P,aR as b,aS as R,aT as Z,aj as O,aU as q}from"./ProjectionTransformation-CSOGIsAN.js";import{getSpatialReference as B,fromSpatialReference as H,fromPolyline as J,fromGeometry as N,toGeometry as W}from"./apiConverter-C4nPBqvs.js";var $=q;function f(l,e){return{m_geometry:l,m_side:e}}function X(l,e,o,t,m,n){if(e.isEmpty()){const a=f(e,0);return void m.push(a)}if(o.isEmpty()){const a=f(e,0);return void m.push(a)}const s=[],r=new x;{const a=r.createGeometryUserIndex(),C=r.addGeometry(e),k=r.addGeometry(o),d=new R(n);let p=0,c=null;if(r.hasCurves()){c=new $;const h=r.getEnvelope2D(n);p=I(t.total());const _=P(t.total(),h);b(r,_,t.total(),12e3,c,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(l,a,C,k,s);for(const h of s){c!==null&&c.stitchCurves(r,h,p,!1);const _=f(r.getGeometry(h),Z(r.getGeometryUserIndex(h,a)));m.push(_)}c!==null&&c.clearStitcher(r)}}function Y(l,e,o,t,m,n){if(e.isEmpty()){const a=f(e,0);return void m.push(a)}if(o.isEmpty()){const a=f(e,0);return void m.push(a)}const s=[],r=new x;{const a=r.createGeometryUserIndex(),C=r.addGeometry(e),k=r.addGeometry(o),d=new R(n);let p=0,c=null;if(r.hasCurves()){c=new $;const i=r.getEnvelope2D(n);p=I(t.total());const y=P(t.total(),i);b(r,y,t.total(),12e3,c,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(!1,a,C,k,s),c!==null&&c.stitchCurves(r,O,p,!0);let h=r.getGeometry(C);const _=new g,E=new g,G=[];for(let i=0;i<s.length;i++){let y=null;{const u=new x,S=u.addGeometry(h),T=u.addGeometry(r.getGeometry(s[i]));if(u.hasCurves()){const D=u.getEnvelope2D(n);p=I(t.total());const z=P(t.total(),D);b(u,z,t.total(),12e3,c,null,n)}d.setEditShapeCrackAndCluster(u,t);const A=d.intersection(S,T);if(c!==null&&c.stitchCurves(u,O,p,!0),y=u.getGeometry(A),y.isEmpty())continue;const v=r.getGeometryUserIndex(s[i],a);v===2?_.add(y,!1):v===1?E.add(y,!1):G.push(y)}{const u=new x,S=u.addGeometry(h),T=u.addGeometry(r.getGeometry(s[i]));if(u.hasCurves()){const v=u.getEnvelope2D(n);p=I(t.total());const D=P(t.total(),v);b(u,D,t.total(),12e3,c,null,n)}d.setEditShapeCrackAndCluster(u,t);const A=d.difference(S,T);c!==null&&c.stitchCurves(u,O,p,!0),h=u.getGeometry(A)}}if(!h.isEmpty()&&s.length>0&&G.push(h),_.isEmpty()&&E.isEmpty())return;if(!_.isEmpty()){const i=f(_,1);m.push(i)}if(!E.isEmpty()){const i=f(E,2);m.push(i)}for(let i=0,y=G.length;i<y;++i){const u=f(G[i],3);m.push(u)}}}class tt{getOperatorType(){return 10005}accelerateGeometry(e,o,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,o,t,m,n){return new et(e,o,t,m,n)}}class et extends K{constructor(e,o,t,m,n){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=n,this.m_cuttee=o.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=M(o,t);this.m_tolerance=Q(m,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case U.enumPolyline:this.generatePolylineCuts();break;case U.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,o=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const m=[];X(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let n=0;n<m.length;n++){const s=m[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}t.isEmpty()||e.isEmpty()&&o.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new g,o=new g,t=new g;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const m=[];Y(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let n=0;n<m.length;n++){const s=m[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}L(t.isEmpty()||m.length===1),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const V=new tt;function st(l,e,o){const t=V.execute(!0,l,e,o,null);return Array.from(t)}function rt(){return V.supportsCurves()}function ot(l,e){const o=B(l);return st(N(l),J(e),H(o)).map((t=>W(t,o))).filter(F)}const nt=rt(),lt=Object.freeze(Object.defineProperty({__proto__:null,execute:ot,supportsCurves:nt},Symbol.toStringTag,{value:"Module"}));export{nt as c,lt as i,ot as m};
