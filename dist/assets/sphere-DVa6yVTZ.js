import{a6 as h,hM as R,eT as G,cq as T,hN as H,az as A,eU as z,hO as L,ax as N,hP as p,a8 as J,hQ as K}from"./index-DzoQLc5A.js";import{A as P,P as m,_ as S,r as f,s as W,c as l,u as q,g as _,o as E,v as tt,p as Z,I as nt,j as et,E as it,q as rt}from"./vec32-LyzMesOw.js";import"./mat3-D2DxLcs1.js";import"./mat3f64-B5o_lm6j.js";import{c as a,f as ot}from"./vectorStacks-BcGsIGGR.js";function Nt(t,e){return m(t,e)/f(t)}function st(t,e){const n=m(t,e)/(f(t)*f(e));return-R(n)}function Zt(t,e,n){P($,t),P(x,e);const i=m($,x),r=R(i),o=S($,$,x);return m(o,n)<0?2*Math.PI-r:r}const $=h(),x=h();class ct{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&G((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*j);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,j));e++)this._items.push(this._allocator())}}const j=1024;function F(t){return t?v(T(t.origin),T(t.direction)):v(h(),h())}function v(t,e){return{origin:t,direction:e}}function Ft(t,e){const n=ft.get();return n.origin=t,n.direction=e,n}function ut(t,e,n=F()){return W(n.origin,t),l(n.direction,e,t),n}function Qt(t,e){const n=S(a.get(),P(a.get(),t.direction),l(a.get(),e,t.origin));return m(n,n)}function at(t,e,n){const i=m(t.direction,l(n,e,t.origin));return q(n,t.origin,_(n,t.direction,i)),n}const ft=new ct((()=>F()));function k(t,e){const n=f(t),i=H(t[2]/n),r=Math.atan2(t[1]/n,t[0]/n);return E(e,n,i,r),e}const ht=C();function C(){return z()}const lt=N,gt=N;function Q(t,e){return A(e,t)}function mt(t,e){return L(t[0],t[1],t[2],e)}function Mt(t){return t}function _t(t){t[0]=t[1]=t[2]=t[3]=0}function dt(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function d(t){return t[3]}function $t(t){return t}function pt(t,e,n,i){return L(t,e,n,i)}function Pt(t,e,n){return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=t[3]+e,n}function St(t,e,n){return t!==n&&Q(t,n),n}function bt(t,e){return e}function w(t,e,n){if(e==null||!U(t,e,b))return!1;let{t0:i,t1:r}=b;if((i<0||r<i&&r>0)&&(i=r),i<0)return!1;if(n){const{origin:o,direction:s}=e;n[0]=o[0]+s[0]*i,n[1]=o[1]+s[1]*i,n[2]=o[2]+s[2]*i}return!0}function qt(t,e,n){const i=ut(e,n);if(!U(t,i,b))return[];const{origin:r,direction:o}=i,{t0:s,t1:c}=b,u=g=>{const M=h();return rt(M,r,o,g),I(t,M,M)};return Math.abs(s-c)<J()?[u(s)]:[u(s),u(c)]}const b={t0:0,t1:0};function U(t,e,n){const{origin:i,direction:r}=e,o=wt;o[0]=i[0]-t[0],o[1]=i[1]-t[1],o[2]=i[2]-t[2];const s=r[0]*r[0]+r[1]*r[1]+r[2]*r[2];if(s===0)return!1;const c=2*(r[0]*o[0]+r[1]*o[1]+r[2]*o[2]),u=c*c-4*s*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(u<0)return!1;const g=Math.sqrt(u);return n.t0=(-c-g)/(2*s),n.t1=(-c+g)/(2*s),!0}const wt=h();function xt(t,e){return w(t,e,null)}function yt(t,e,n){if(w(t,e,n))return n;const i=V(t,e,a.get());return q(n,e.origin,_(a.get(),e.direction,Z(e.origin,i)/f(e.direction))),n}function V(t,e,n){const i=a.get(),r=ot.get();S(i,e.origin,e.direction);const o=d(t);S(n,i,e.origin),_(n,n,1/f(n)*o);const s=X(t,e.origin),c=st(e.origin,n);return K(r,c+s,i),it(n,n,r),n}function At(t,e,n,i){const r=d(t),o=r*r,s=e+.5*Math.PI,c=n*n+o-2*Math.cos(s)*n*r,u=Math.sqrt(c),g=c-o;if(g<=0)return .5;const M=Math.sqrt(g),D=Math.acos(M/u)-Math.asin(r/(u/Math.sin(s)));return Math.min(1,(D+.5*i)/i)}function Et(t,e,n){return w(t,e,n)?n:(at(e,t,n),I(t,n,n))}function I(t,e,n){const i=l(a.get(),e,t),r=_(a.get(),i,t[3]/f(i));return q(n,r,t)}function Ot(t,e){const n=l(a.get(),e,t),i=et(n),r=t[3]*t[3];return Math.sqrt(Math.abs(i-r))}function X(t,e){const n=l(a.get(),e,t),i=f(n),r=d(t),o=r+Math.abs(r-i);return R(r/o)}const y=h();function Y(t,e,n,i){const r=l(y,e,t);switch(n){case p.X:{const o=k(r,y)[2];return E(i,-Math.sin(o),Math.cos(o),0)}case p.Y:{const o=k(r,y),s=o[1],c=o[2],u=Math.sin(s);return E(i,-u*Math.cos(c),-u*Math.sin(c),Math.cos(s))}case p.Z:return P(i,r);default:return}}function B(t,e){const n=l(O,e,t);return f(n)-t[3]}function Rt(t,e,n,i){const r=B(t,e),o=Y(t,e,p.Z,O),s=_(O,o,n-r);return q(i,e,s)}function Ct(t,e){const n=tt(t,e),i=d(t);return n<=i*i}function It(t,e,n=z()){const i=Z(t,e),r=t[3],o=e[3];return i+o<r?(A(n,t),n):i+r<o?(A(n,e),n):(nt(n,t,e,(i+o-r)/(2*i)),n[3]=(i+r+o)/2,n)}const O=h(),Tt=C(),Ut=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:ht,altitudeAt:B,angleToSilhouette:X,axisAt:Y,cameraFrustumCoverage:At,clear:_t,closestPoint:Et,closestPointOnSilhouette:V,containsPoint:Ct,copy:Q,create:C,distanceToSilhouette:Ot,elevate:Pt,equals:gt,exactEquals:lt,fromCenterAndRadius:mt,fromRadius:dt,fromValues:pt,getCenter:$t,getExtent:bt,getRadius:d,intersectLine:qt,intersectRay:w,intersectRayClosestSilhouette:yt,intersectsRay:xt,projectPoint:I,setAltitudeAt:Rt,setExtent:St,tmpSphere:Tt,union:It,wrap:Mt},Symbol.toStringTag,{value:"Module"}));export{C as E,xt as H,d as N,$t as U,pt as V,Nt as a,F as b,Qt as c,Ut as f,Ct as i,Ft as k,ct as s,Zt as u,Q as w};
